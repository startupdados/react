import{f as w,i as E,j as e,a2 as B,r as o,B as p,a3 as K,A as Q,T as f,a0 as X,a5 as Z}from"./index-abcHMAUO.js";import{d as ee,C as te}from"./Search-j-ETTPZQ.js";import{u as j}from"./userService-CB-I6QY0.js";import{d as n,T as re,a as oe,b as ae,c as _,e as D,f as se}from"./TableSortLabel-CHxKLulo.js";import{T as ne,S as le}from"./TextField-QOU9EbB3.js";import{I as ie}from"./InputAdornment-CXn_n6Xw.js";import{B as k}from"./Button-DNQi5Rop.js";import{I as C}from"./IconButton-CKWWzIqv.js";import{M as ce}from"./MenuItem-CkW96tJd.js";import"./OutlinedInput-CG80is10.js";var R={},de=E;Object.defineProperty(R,"__esModule",{value:!0});var S=R.default=void 0,xe=de(w()),he=e;S=R.default=(0,xe.default)((0,he.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var T={},ue=E;Object.defineProperty(T,"__esModule",{value:!0});var $=T.default=void 0,pe=ue(w()),me=e;$=T.default=(0,pe.default)((0,me.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit");var I={},fe=E;Object.defineProperty(I,"__esModule",{value:!0});var z=I.default=void 0,je=fe(w()),ve=e;z=I.default=(0,je.default)((0,ve.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete");const c=B(n)(({theme:l})=>({backgroundColor:l.palette.primary.main,color:"white",textAlign:"center",padding:"16px"})),ge=B(re)(({theme:l})=>({borderRadius:"12px",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.1)",width:"70vw",overflowY:"auto","&::-webkit-scrollbar":{width:"2px"},"&::-webkit-scrollbar-thumb":{backgroundColor:l.palette.primary.light,borderRadius:"2px"}})),be=({employees:l,isAdmin:x,onUpdate:h})=>{const[i,v]=o.useState("asc"),[s,g]=o.useState("name"),[u,m]=o.useState(""),[b,a]=o.useState(!1),[L,y]=o.useState(!1),[O,q]=o.useState(null),[M,P]=o.useState(null),[F,H]=o.useState([]);o.useEffect(()=>{(async()=>{try{const r=await j.getUsersRoles();H(r)}catch(r){console.error("Erro ao buscar roles:",r)}})()},[]);const A=t=>{v(s===t&&i==="asc"?"desc":"asc"),g(t)},U=t=>{q(t),a(!0)},N=async()=>{try{await j.deleteUser(O.id),h()}catch(t){console.error("Erro ao deletar funcionário:",t)}a(!1)},V=t=>{P(t),y(!0)},W=t=>{h(),y(!1)},Y=async(t,r)=>{try{await j.updateUserRole(t.id,r),h()}catch(d){console.error("Erro ao atualizar role:",d)}},G=t=>{m(t.target.value)},J=(t=>t.sort((r,d)=>s==="name"?i==="asc"?r.name.localeCompare(d.name):d.name.localeCompare(r.name):i==="asc"?r.id-d.id:d.id-r.id))(l.filter(t=>t.name.toLowerCase().includes(u.toLowerCase())));return e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs("div",{children:[e.jsxs(p,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx(ne,{placeholder:"Filtrar por nome",variant:"outlined",value:u,onChange:G,InputProps:{startAdornment:e.jsx(ie,{position:"start",children:e.jsx(ee,{})})},sx:{flex:1,marginRight:"10px"}}),e.jsx(k,{variant:"contained",color:"primary",startIcon:e.jsx(S,{}),sx:{whiteSpace:"nowrap",padding:"10px 20px",display:{xs:"none",sm:"inline-flex"}},onClick:()=>console.log("Cadastrar novo integrante"),children:"Cadastrar Novo Integrante"}),e.jsx(C,{color:"primary",sx:{display:{xs:"inline-flex",sm:"none"},marginLeft:"10px"},onClick:()=>console.log("Cadastrar novo integrante"),children:e.jsx(S,{})})]}),e.jsx(ge,{component:K,children:e.jsxs(oe,{stickyHeader:!0,children:[e.jsx(ae,{children:e.jsxs(_,{children:[e.jsx(c,{children:"Foto"}),e.jsx(c,{children:e.jsx(D,{active:s==="id",direction:s==="id"?i:"asc",onClick:()=>A("id"),sx:{color:"white","& .MuiTableSortLabel-icon":{color:"white !important",position:"absolute",right:"-20px"},"&:hover":{color:"white"},"&.Mui-active":{color:"white"}},children:"ID"})}),e.jsx(c,{children:e.jsx(D,{active:s==="name",direction:s==="name"?i:"asc",onClick:()=>A("name"),sx:{color:"white","& .MuiTableSortLabel-icon":{color:"white !important",position:"absolute",right:"-20px"},"&:hover":{color:"white"},"&.Mui-active":{color:"white"}},children:"Nome e Email"})}),e.jsx(c,{children:"Telefone"}),e.jsx(c,{children:"Aniversário"}),e.jsx(c,{children:"Cargo"}),x&&e.jsx(c,{children:"Ações"})]})}),e.jsx(se,{children:J.map(t=>e.jsxs(_,{children:[e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(Q,{alt:t.name,src:t.photo||"https://via.placeholder.com/150",sx:{width:60,height:60}})}),e.jsx(n,{sx:{textAlign:"center"},children:t.id}),e.jsx(n,{sx:{textAlign:"left"},children:e.jsxs(p,{children:[e.jsx(f,{sx:{marginBottom:"0.2rem"},children:t.name})," ",e.jsx(f,{sx:{fontSize:"0.8rem"},children:t.email})," "]})}),e.jsx(n,{sx:{textAlign:"center"},children:t.phone}),e.jsx(n,{sx:{textAlign:"center"},children:t.birthday}),e.jsx(n,{sx:{textAlign:"center"},children:x?e.jsx(le,{value:t.role,onChange:r=>Y(t,r.target.value),sx:{width:150},children:F.map(r=>e.jsx(ce,{value:r,sx:{minWidth:150},children:r},r))}):t.role}),x&&e.jsxs(n,{sx:{textAlign:"center"},children:[e.jsx(C,{color:"primary",onClick:()=>V(t),children:e.jsx($,{})}),e.jsx(C,{color:"error",onClick:()=>U(t),children:e.jsx(z,{})})]})]},t.id))})]})}),e.jsx(X,{open:b,onClose:()=>a(!1),children:e.jsxs(p,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:"12px",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(f,{variant:"h6",gutterBottom:!0,sx:{fontSize:"24px"},children:"Deseja confirmar a exclusão?"}),e.jsx(k,{variant:"contained",color:"error",onClick:N,fullWidth:!0,sx:{fontSize:"18px"},children:"CONFIRMAR"})]})}),M&&e.jsx(EditEmployeeModal,{open:L,onClose:()=>y(!1),employee:M,onSave:W})]})})},De=()=>{const[l,x]=o.useState([]),[h,i]=o.useState(!1),[v,s]=o.useState(!0),g=Z.getUserInfo();o.useEffect(()=>{i(g.role==="admin")},[]);const u=async()=>{s(!0);try{const b=(await j.getUsers()).map(a=>({id:a.id,name:`${a.firstName} ${a.lastName}`,email:a.email,phone:a.phone,birthday:new Date(a.birthDate).toLocaleDateString("pt-BR"),role:a.role,photo:a.photo||"https://via.placeholder.com/150"}));x(b)}catch(m){console.error("Erro ao buscar usuários:",m)}finally{s(!1)}};return o.useEffect(()=>{u()},[]),e.jsxs("div",{children:[e.jsx(f,{variant:"h1",sx:{fontSize:"32px",fontWeight:"bold",marginBottom:"20px"},children:"Equipe"}),v?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:e.jsx(te,{})}):e.jsx(be,{employees:l,isAdmin:h,onUpdate:u})]})};export{De as default};
